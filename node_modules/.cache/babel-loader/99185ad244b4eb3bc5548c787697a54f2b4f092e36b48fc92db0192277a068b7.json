{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import*as d3 from\"d3\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";const HierarchicalChart=()=>{const svgRef=useRef();const[dimensions,setDimensions]=useState({width:2500,height:2200});const[chartData,setChartData]=useState([]);const GOOGLE_SHEET_ID=\"1Hmm4S0zlaFxMdT8onJQbqCK6KS0Fl9yc5vtr-Msae6U\";// Reemplaza con tu ID\nconst GOOGLE_SHEET_TAB=\"1\";// Número de pestaña (hoja) en Google Sheets\nconst API_URL=`https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:json&sheet=${GOOGLE_SHEET_TAB}`;useEffect(()=>{const fetchData=async()=>{try{const response=await axios.get(API_URL);const jsonData=JSON.parse(response.data.substring(47).slice(0,-2));const rows=jsonData.table.rows.map(row=>{var _row$c$,_row$c$2,_row$c$3,_row$c$3$v;return{id:((_row$c$=row.c[0])===null||_row$c$===void 0?void 0:_row$c$.v.toString())||\"\",name:((_row$c$2=row.c[1])===null||_row$c$2===void 0?void 0:_row$c$2.v)||\"\",parent:((_row$c$3=row.c[2])===null||_row$c$3===void 0?void 0:(_row$c$3$v=_row$c$3.v)===null||_row$c$3$v===void 0?void 0:_row$c$3$v.toString())||\"\"};});setChartData(rows);}catch(error){console.error(\"Error fetching Google Sheet data:\",error);}};fetchData();},[]);useEffect(()=>{if(chartData.length===0)return;const svg=d3.select(svgRef.current);svg.selectAll(\"*\").remove();const margin={top:100,right:200,bottom:100,left:500};const width=dimensions.width-margin.left-margin.right;const height=dimensions.height-margin.top-margin.bottom;// Background pattern with dots every 2cm with 40% opacity\nconst defs=svg.append(\"defs\");const pattern=defs.append(\"pattern\").attr(\"id\",\"dot-pattern\").attr(\"width\",75).attr(\"height\",75).attr(\"patternUnits\",\"userSpaceOnUse\");pattern.append(\"circle\").attr(\"cx\",37.5).attr(\"cy\",37.5).attr(\"r\",3).attr(\"fill\",\"#d0d7de\").attr(\"opacity\",\"0.4\");svg.style(\"background\",\"white\");svg.append(\"rect\").attr(\"width\",dimensions.width).attr(\"height\",dimensions.height).attr(\"fill\",\"url(#dot-pattern)\");const g=svg.append(\"g\").attr(\"transform\",`translate(${margin.left},${margin.top})`);const stratify=d3.stratify().id(d=>d.id).parentId(d=>d.parent);const root=stratify(chartData);const treeLayout=d3.tree().size([height,width]).separation((a,b)=>a.parent===b.parent?5:7);treeLayout(root);const linkGenerator=d3.linkHorizontal().x(d=>d.y).y(d=>d.x);g.selectAll(\"path\").data(root.links()).enter().append(\"path\").attr(\"d\",linkGenerator).attr(\"fill\",\"none\").attr(\"stroke\",\"#bbb\").attr(\"stroke-width\",2);const node=g.selectAll(\"g.node\").data(root.descendants()).enter().append(\"g\").attr(\"class\",\"node\").attr(\"transform\",d=>`translate(${d.y},${d.x})`);node.append(\"rect\").attr(\"width\",d=>d.data.name.length*14+80).attr(\"height\",d=>d.data.name.includes(\"Phase\")?20:60).attr(\"x\",d=>-(d.data.name.length*7+40)).attr(\"y\",d=>d.data.name.includes(\"Phase\")?-10:-30).attr(\"rx\",6).attr(\"ry\",6).attr(\"fill\",\"#f8f8f8\").attr(\"stroke\",\"#bbb\").attr(\"stroke-width\",2).style(\"filter\",\"drop-shadow(4px 4px 10px rgba(255,255,255,0.5))\").on(\"click\",(event,d)=>alert(`Clicked on: ${d.data.name}`));node.append(\"text\").attr(\"x\",0).attr(\"y\",d=>d.data.name.includes(\"Phase\")?3:5).attr(\"text-anchor\",\"middle\").attr(\"fill\",\"black\").style(\"font-size\",d=>d.data.name.includes(\"Phase\")?\"8px\":\"14px\").text(d=>d.data.name);},[dimensions,chartData]);return/*#__PURE__*/_jsx(\"svg\",{ref:svgRef,width:dimensions.width,height:dimensions.height,viewBox:`0 0 ${dimensions.width} ${dimensions.height}`});};export default HierarchicalChart;","map":{"version":3,"names":["React","useEffect","useRef","useState","d3","axios","jsx","_jsx","HierarchicalChart","svgRef","dimensions","setDimensions","width","height","chartData","setChartData","GOOGLE_SHEET_ID","GOOGLE_SHEET_TAB","API_URL","fetchData","response","get","jsonData","JSON","parse","data","substring","slice","rows","table","map","row","_row$c$","_row$c$2","_row$c$3","_row$c$3$v","id","c","v","toString","name","parent","error","console","length","svg","select","current","selectAll","remove","margin","top","right","bottom","left","defs","append","pattern","attr","style","g","stratify","d","parentId","root","treeLayout","tree","size","separation","a","b","linkGenerator","linkHorizontal","x","y","links","enter","node","descendants","includes","on","event","alert","text","ref","viewBox"],"sources":["/Users/vilz/Documents/Mindmap Matrioska/src/mindmap.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport * as d3 from \"d3\";\nimport axios from \"axios\";\n\nconst HierarchicalChart = () => {\n  const svgRef = useRef();\n  const [dimensions, setDimensions] = useState({ width: 2500, height: 2200 });\n  const [chartData, setChartData] = useState([]);\n\n  const GOOGLE_SHEET_ID = \"1Hmm4S0zlaFxMdT8onJQbqCK6KS0Fl9yc5vtr-Msae6U\"; // Reemplaza con tu ID\n  const GOOGLE_SHEET_TAB = \"1\"; // Número de pestaña (hoja) en Google Sheets\n  const API_URL = `https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:json&sheet=${GOOGLE_SHEET_TAB}`;\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(API_URL);\n        const jsonData = JSON.parse(response.data.substring(47).slice(0, -2));\n        const rows = jsonData.table.rows.map(row => ({\n          id: row.c[0]?.v.toString() || \"\",\n          name: row.c[1]?.v || \"\",\n          parent: row.c[2]?.v?.toString() || \"\",\n        }));\n        setChartData(rows);\n      } catch (error) {\n        console.error(\"Error fetching Google Sheet data:\", error);\n      }\n    };\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    if (chartData.length === 0) return;\n    const svg = d3.select(svgRef.current);\n    svg.selectAll(\"*\").remove();\n\n    const margin = { top: 100, right: 200, bottom: 100, left: 500 };\n    const width = dimensions.width - margin.left - margin.right;\n    const height = dimensions.height - margin.top - margin.bottom;\n\n    // Background pattern with dots every 2cm with 40% opacity\n    const defs = svg.append(\"defs\");\n    const pattern = defs.append(\"pattern\")\n      .attr(\"id\", \"dot-pattern\")\n      .attr(\"width\", 75)\n      .attr(\"height\", 75)\n      .attr(\"patternUnits\", \"userSpaceOnUse\");\n\n    pattern.append(\"circle\")\n      .attr(\"cx\", 37.5)\n      .attr(\"cy\", 37.5)\n      .attr(\"r\", 3)\n      .attr(\"fill\", \"#d0d7de\")\n      .attr(\"opacity\", \"0.4\");\n\n    svg.style(\"background\", \"white\");\n    svg.append(\"rect\")\n      .attr(\"width\", dimensions.width)\n      .attr(\"height\", dimensions.height)\n      .attr(\"fill\", \"url(#dot-pattern)\");\n    \n    const g = svg\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n\n    const stratify = d3.stratify()\n      .id(d => d.id)\n      .parentId(d => d.parent);\n\n    const root = stratify(chartData);\n    const treeLayout = d3.tree().size([height, width]).separation((a, b) => a.parent === b.parent ? 5 : 7);\n    treeLayout(root);\n\n    const linkGenerator = d3.linkHorizontal()\n      .x(d => d.y)\n      .y(d => d.x);\n\n    g.selectAll(\"path\")\n      .data(root.links())\n      .enter()\n      .append(\"path\")\n      .attr(\"d\", linkGenerator)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"#bbb\")\n      .attr(\"stroke-width\", 2);\n\n    const node = g.selectAll(\"g.node\")\n      .data(root.descendants())\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"node\")\n      .attr(\"transform\", d => `translate(${d.y},${d.x})`);\n\n    node.append(\"rect\")\n      .attr(\"width\", d => d.data.name.length * 14 + 80)\n      .attr(\"height\", d => d.data.name.includes(\"Phase\") ? 20 : 60)\n      .attr(\"x\", d => -(d.data.name.length * 7 + 40))\n      .attr(\"y\", d => d.data.name.includes(\"Phase\") ? -10 : -30)\n      .attr(\"rx\", 6)\n      .attr(\"ry\", 6)\n      .attr(\"fill\", \"#f8f8f8\")\n      .attr(\"stroke\", \"#bbb\")\n      .attr(\"stroke-width\", 2)\n      .style(\"filter\", \"drop-shadow(4px 4px 10px rgba(255,255,255,0.5))\")\n      .on(\"click\", (event, d) => alert(`Clicked on: ${d.data.name}`));\n\n    node.append(\"text\")\n      .attr(\"x\", 0)\n      .attr(\"y\", d => d.data.name.includes(\"Phase\") ? 3 : 5)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"fill\", \"black\")\n      .style(\"font-size\", d => d.data.name.includes(\"Phase\") ? \"8px\" : \"14px\")\n      .text(d => d.data.name);\n  }, [dimensions, chartData]);\n\n  return (\n    <svg ref={svgRef} width={dimensions.width} height={dimensions.height} viewBox={`0 0 ${dimensions.width} ${dimensions.height}`} />\n  );\n};\n\nexport default HierarchicalChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}